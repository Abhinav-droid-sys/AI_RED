<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>RED — Your intelligent AI companion</title>
  <meta name="description" content="RED — intelligent, fast AI assistant for students, developers and creators. Chat instantly." />

  <!-- Favicon -->
  <link rel="icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 32 32'%3E%3Crect width='32' height='32' rx='6' fill='%23FF3B30'/%3E%3Ctext x='50%25' y='55%25' font-size='18' text-anchor='middle' font-family='Inter, Arial, sans-serif' fill='white' font-weight='700'%3ER%3C/text%3E%3C/svg%3E" />

  <!-- Fonts & Icons -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" crossorigin="anonymous">

  <style>
    :root {
      --primary: #FF3B30;
      --primary-light: #FF6B6B;
      --bg-dark: #0A0A0B;
      --card-bg: rgba(18,18,20,0.9);
      --glass-bg: rgba(255,255,255,0.04);
      --glass-border: rgba(255,255,255,0.06);
      --text-main: #FFFFFF;
      --text-muted: #999;
      --border-color: #26262C;
    }
    * { box-sizing: border-box; margin:0; padding:0; }
    html, body { height: 100%; }
    body { 
      font-family: 'Inter', system-ui, -apple-system, sans-serif;
      background: var(--bg-dark);
      color: var(--text-main);
      overflow: hidden;
    }

    /* ---------------- Sidebar toolbar ---------------- */
    #sideToolbar {
      position: fixed;
      top: 0; left: 0;
      height: 100vh;
      width: 64px;
      background: var(--card-bg);
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 8px 0;
      gap: 12px;
      transition: transform 1s ease, opacity 1s ease;
      z-index: 1000;
    }
    #sideToolbar.hidden {
      transform: translateX(-100%);
      opacity: 0;
    }
    .toolbar-btn {
      background: var(--primary);
      border: none;
      color: white;
      padding: 10px;
      border-radius: 8px;
      cursor: pointer;
      width: 44px;
      height: 44px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 16px;
    }
    .toolbar-btn:hover {
      background: var(--primary-light);
    }
    /* when expanded toolbar (optional icons + labels) */
    .toolbar-label {
      margin-top: 4px;
      font-size: 10px;
      color: var(--text-muted);
      text-align: center;
      line-height: 1.2;
    }

    /* ---------------- Main layout ---------------- */
    .wrapper {
      display: flex;
      height: 100vh;
      margin-left: 64px; /* leave space for toolbar */
      transition: margin-left 1s ease;
    }
    .wrapper.full {
      margin-left: 0px;
    }

    .chat-panel {
      flex:1;
      display: flex;
      flex-direction: column;
      height: 100%;
      background: var(--card-bg);
    }

    .chat-header {
      padding: 16px;
      border-bottom: 1px solid var(--border-color);
      backdrop-filter: blur(12px) saturate(1.1);
      background: var(--glass-bg);
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    .chat-title {
      font-size: 20px;
      font-weight: 700;
      background: linear-gradient(135deg, var(--primary), var(--primary-light));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }
    .chat-sub {
      color: var(--text-muted);
      font-size: 13px;
      margin-top: 4px;
    }

    .messages {
      flex:1;
      overflow-y: auto;
      padding: 18px;
      display: flex;
      flex-direction: column;
      gap: 14px;
    }
    .message {
      opacity: 0;
      transform: translateY(8px);
      transition: opacity 0.25s ease, transform 0.25s ease;
      max-width: 75%;
      word-wrap: break-word;
      padding: 14px 16px;
      border-radius: 14px;
      font-size: 15px;
      line-height: 1.4;
    }
    .message.user {
      align-self: flex-end;
      background: linear-gradient(135deg, var(--primary), var(--primary-light));
      color: white;
      box-shadow: 0 8px 24px rgba(255,59,48,0.12);
    }
    .message.assistant {
      align-self: flex-start;
      background: var(--card-bg);
      color: var(--text-main);
      border: 1px solid var(--border-color);
    }
    .message.show {
      opacity: 1;
      transform: translateY(0);
    }

    .input-area {
      padding: 14px;
      border-top: 1px solid var(--border-color);
      backdrop-filter: blur(12px) saturate(1.1);
      background: var(--glass-bg);
      display:flex; gap:10px;
    }
    #messageInput {
      flex:1;
      padding: 14px 12px 8px 12px;
      background: transparent;
      color: var(--text-main);
      border: 1px solid var(--border-color);
      border-radius: 10px;
      resize: none;
      min-height: 64px;
      max-height: 160px;
      font-size: 15px;
      line-height: 1.4;
    }
    #sendBtn {
      width: 50px; height: 50px;
      border: none; border-radius: 10px;
      background: linear-gradient(135deg, var(--primary), var(--primary-light));
      color: white; cursor: pointer;
      display: flex; align-items:center; justify-content:center;
      font-size: 18px;
    }

    /* for incognito / other overlays (if needed) */
  </style>
</head>
<body>
  <!-- Sidebar toolbar -->
  <div id="sideToolbar" class="visible">
    <button id="sidebarToggleBtn" class="toolbar-btn" title="Hide sidebar">
      <i class="fas fa-bars"></i>
    </button>
    <button id="newChatBtn_tool" class="toolbar-btn" title="New chat">
      <i class="fas fa-plus"></i>
    </button>
    <button id="clearChatsBtn" class="toolbar-btn" title="Clear all chats">
      <i class="fas fa-trash"></i>
    </button>
    <!-- You could add history list or other toolbar-icons here -->
  </div>

  <!-- Main wrapper (chat panel) -->
  <div class="wrapper" id="mainWrapper">
    <div class="chat-panel">
      <header class="chat-header">
        <div>
          <div class="chat-title">RED</div>
          <div class="chat-sub" id="chatSubtitle">Your intelligent AI companion</div>
        </div>
        <!-- (You can keep status / incognito / other controls here) -->
      </header>

      <div class="messages" id="messages">
        <!-- placeholder when no message -->
        <div class="empty-state" style="color: var(--text-muted); text-align:center; margin-top:40px;">
          No messages yet — start the conversation.
        </div>
      </div>

      <div class="input-area">
        <textarea id="messageInput" placeholder="Ask me anything..." autocomplete="off"></textarea>
        <button id="sendBtn"><i class="fas fa-paper-plane"></i></button>
      </div>
    </div>
  </div>

  <script>
    // Sidebar toggle logic
    const sidebarToggleBtn = document.getElementById('sidebarToggleBtn');
    const sideToolbar = document.getElementById('sideToolbar');
    const mainWrapper = document.getElementById('mainWrapper');

    sidebarToggleBtn.addEventListener('click', () => {
      sideToolbar.classList.toggle('hidden');
      mainWrapper.classList.toggle('full');
    });

    // Chat storage & clear-all logic
    const clearChatsBtn = document.getElementById('clearChatsBtn');

    clearChatsBtn.addEventListener('click', () => {
      if (!confirm("Clear all chats? This cannot be undone.")) return;
      try { localStorage.removeItem('red_chats'); } catch(e){}
      // Clear UI messages & reset
      document.getElementById('messages').innerHTML = '';
      const empty = document.createElement('div');
      empty.className = 'empty-state';
      empty.style.color = 'var(--text-muted)';
      empty.style.textAlign = 'center';
      empty.style.marginTop = '40px';
      empty.textContent = 'No messages yet — start the conversation.';
      document.getElementById('messages').append(empty);
      // Optionally reload or reset app state — depends on your JS logic
    });

    // Example send message logic (you already have real backend calling logic)
    const sendBtn = document.getElementById('sendBtn');
    const messageInput = document.getElementById('messageInput');
    const messagesDiv = document.getElementById('messages');

    sendBtn.addEventListener('click', sendMessage);
    messageInput.addEventListener('keydown', (e) => {
      if (e.key === 'Enter' && !e.shiftKey) {
        e.preventDefault();
        sendMessage();
      }
    });

    function sendMessage(){
      const text = messageInput.value.trim();
      if (!text) return;
      messageInput.value = '';
      addMessage(text, 'user');
      // Here you call your /api/chat to get response then add assistant message
      // For demo we just echo
      setTimeout(() => {
        addMessage("This is a demo reply.", 'assistant');
      }, 800);
    }

    function addMessage(content, role){
      const msg = document.createElement('div');
      msg.className = 'message ' + role;
      msg.innerHTML = content.replace(/\n/g, '<br>');
      messagesDiv.appendChild(msg);
      // trigger fade-in
      setTimeout(() => msg.classList.add('show'), 50);
      messagesDiv.scrollTop = messagesDiv.scrollHeight;
    }
  </script>
</body>
</html>
